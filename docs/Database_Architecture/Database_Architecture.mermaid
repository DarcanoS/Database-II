graph TD
    %% CLIENTS
    subgraph Clients
        CitizenWeb[Citizen Web Client]
        Researcher[Researcher Client]
        Admin[Technical Admin Client]
    end

    %% WEB FRONTEND
    subgraph WebLayer
        WebFrontend[Web Frontend Application]
    end

    %% API LAYER
    subgraph APILayer
        ApiPublic[Public REST API]
        ApiAdmin[Admin REST API]
    end

    %% DATA CORE
    subgraph DataLayer
        PG[PostgreSQL Operational and Analytics]
        NoSQL[NoSQL Document Store]
    end

    %% BATCH JOBS
    subgraph BatchJobs
        ExternalAPI[External Air Quality APIs]
        IngestionJob[Ingestion Job Scheduled]
        Normalizer[Normalizer and Validator]
        DailyAgg[Daily Aggregation Job]
    end

    %% OBSERVABILITY
    subgraph Observability
        AppLogs[Application Logs]
    end

    %% CLIENTS -> WEB
    CitizenWeb --> WebFrontend
    Researcher --> WebFrontend
    Admin --> WebFrontend

    %% WEB -> API
    WebFrontend -->|REST JSON| ApiPublic
    WebFrontend -->|REST JSON Admin| ApiAdmin

    %% API -> DATA
    ApiPublic --> PG
    ApiPublic --> NoSQL
    ApiAdmin --> PG
    ApiAdmin --> NoSQL

    %% INGESTION FLOW
    ExternalAPI --> IngestionJob
    IngestionJob --> Normalizer
    Normalizer --> PG

    %% DAILY AGGREGATION
    DailyAgg --> PG

    %% API READS
    ApiPublic -. Read current and daily stats .-> PG
    ApiPublic -. Read preferences and dashboards .-> NoSQL

    %% LOGS
    ApiPublic --> AppLogs
    ApiAdmin --> AppLogs
    IngestionJob --> AppLogs
    Normalizer --> AppLogs
    DailyAgg --> AppLogs